
/* empty css         */document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".ufsc-table td, .ufsc-table th").forEach(i=>{i.getAttribute("title")||i.setAttribute("title",i.textContent.trim())});const a=document.querySelector(".wrap .tablenav.top");a&&(a.style.position="sticky",a.style.top="32px",a.style.zIndex="10",a.style.background="#fff")});window.UFSCLicenceActions=window.UFSCLicenceActions||{};(function(a){var i=window.ufscLicenceConfig||{nonces:{},ajaxUrl:"",messages:{}};function l(e,t){if(!e){alert("ID de licence manquant.");return}var c="Êtes-vous sûr de vouloir supprimer la licence de "+t+" ?";if(confirm(c)){var n=a('[data-licence-id="'+e+'"] .delete-licence-btn'),s=n.text();n.text("Suppression...").prop("disabled",!0),a.ajax({url:i.ajaxUrl,type:"POST",data:{action:"ufsc_delete_licence",licence_id:e,nonce:i.nonces.delete_licence},success:function(o){if(o.success){var u=a('[data-licence-id="'+e+'"]');u.fadeOut(300,function(){u.remove(),r(o.data||"Licence supprimée avec succès.","success")})}else r(o.data||"Erreur lors de la suppression.","error"),n.text(s).prop("disabled",!1)},error:function(){r("Erreur de connexion.","error"),n.text(s).prop("disabled",!1)}})}}function d(e){if(!e){alert("ID de licence manquant.");return}var t=a('[data-licence-id="'+e+'"] .restore-licence-btn'),c=t.text();t.text("Restauration...").prop("disabled",!0),a.ajax({url:i.ajaxUrl,type:"POST",data:{action:"ufsc_restore_licence",licence_id:e,nonce:i.nonces.restore_licence},success:function(n){n.success?r(n.data||"Licence restaurée avec succès.","success"):(r(n.data||"Erreur lors de la restauration.","error"),t.text(c).prop("disabled",!1))},error:function(){r("Erreur de connexion.","error"),t.text(c).prop("disabled",!1)}})}function f(e,t,c,n){if(!e||!t){alert("Paramètres manquants.");return}c=c||"Mise à jour...",n=n||"";var s=a('[data-licence-id="'+e+'"] .status-btn'),o=s.text();s.text(c).prop("disabled",!0),a.ajax({url:i.ajaxUrl,type:"POST",data:{action:"ufsc_change_licence_status",licence_id:e,new_status:t,reason:n,nonce:i.nonces.change_licence_status},success:function(u){u.success?(x(e,t),r(u.data||"Statut mis à jour avec succès.","success")):(r(u.data||"Erreur lors de la mise à jour.","error"),s.text(o).prop("disabled",!1))},error:function(){r("Erreur de connexion.","error"),s.text(o).prop("disabled",!1)}})}function v(e){if(!e){alert("ID de licence manquant.");return}var t=a('[data-licence-id="'+e+'"] .validate-licence-btn'),c=t.text();t.text("Validation...").prop("disabled",!0),a.ajax({url:i.ajaxUrl,type:"POST",data:{action:"ufsc_validate_licence",licence_id:e,nonce:i.nonces.validate_licence},success:function(n){if(n.success){x(e,"validee");var s=n.data&&n.data.message?n.data.message:"Licence validée avec succès.";r(s,"success")}else r(n.data||"Erreur lors de la validation.","error"),t.text(c).prop("disabled",!1)},error:function(){r("Erreur de connexion.","error"),t.text(c).prop("disabled",!1)}})}function p(e){var t=prompt("Raison du refus (optionnel):");t!==null&&f(e,"refusee","Refus...",t)}function x(e,t){var c=a('[data-licence-id="'+e+'"]'),n=c.find(".status-cell");n.removeClass("status-validee status-refusee status-en_attente"),n.addClass("status-"+t);var s=m(t);n.find(".status-text").text(s),b(e,t)}function m(e){var t={en_attente:"En attente",validee:"Validée",refusee:"Refusée"};return t[e]||e}function b(e,t){var c=a('[data-licence-id="'+e+'"]'),n=c.find(".actions-cell");n.find(".validate-btn").toggle(t!=="validee"),n.find(".reject-btn").toggle(t!=="refusee")}function r(e,t){t=t||"info";var c=a('<div class="notice notice-'+t+' is-dismissible"><p>'+e+"</p></div>"),n=a(".ufsc-messages");n.length?n.html(c):a(".wrap h1").after(c),setTimeout(function(){c.fadeOut()},5e3)}function g(){a(document).on("click",".delete-licence-btn",function(e){e.preventDefault();var t=a(this).data("licence-id"),c=a(this).data("licence-name");l(t,c)}),a(document).on("click",".validate-licence-btn",function(e){e.preventDefault();var t=a(this).data("licence-id");v(t)}),a(document).on("click",".reject-licence-btn",function(e){e.preventDefault();var t=a(this).data("licence-id");p(t)}),a(document).on("click",".restore-licence-btn",function(e){e.preventDefault();var t=a(this).data("licence-id");d(t)}),a(document).on("click",".change-status-btn",function(e){e.preventDefault();var t=a(this).data("licence-id"),c=a(this).data("new-status"),n=a(this).data("loading-text")||"Mise à jour...";f(t,c,n)})}UFSCLicenceActions={deleteLicence:l,changeLicenceStatus:f,validateLicence:v,rejectLicence:p,restoreLicence:d,showMessage:r,init:function(e){e&&(i=a.extend(i,e)),g()}},a(document).ready(function(){UFSCLicenceActions.init()})})(jQuery);$(document).on("click",".change-status-approve, .change-status-refuse",function(a){a.preventDefault();var i=$(this),l=parseInt(i.data("licence-id"),10),d=i.data("new-status");changeLicenceStatus(l,d,i.text())});

import { initButtons } from '../src/components/buttons.js';
import { initModals } from '../src/components/modal.js';
import { showToast } from '../src/components/toast.js';

window.UFSCAdmin = {
  initButtons,
  initModals,
  showToast
};

document.addEventListener('DOMContentLoaded', () => {
  initButtons();
  initModals();
});

